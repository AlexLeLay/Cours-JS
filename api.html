<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/api.js" defer></script>
    <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-json.min.js"></script>
    <title>Les api, les promises, les ajax</title>
</head>
<body>
    <main>
        <h1>API, JSON, PROMISE, AJAX</h1>
        <h2>LES APIs</h2>
        <p>API : Application Programming Interface</p>
        <p>C'est une interface qui permet à au moins deux programmes ou services de communiquer entre eux</p>
        <p>Exemple métaphorique :</p>
        <ul>
            <li>Tu es le <b>client</b> (le frontend, cad le navigateur)</li>
            <li>Tu commandes un plat</li>
            <li>Le <b>cuisinier</b> (le serveur du backend) le prépare</li>
            <li>Le cuisinier prépare le plat à partir du garde manger (la base de données) dans la cuisine (serveur API)</li>
            <li>L' <b>AJAX ou FETCH</b> joue le rôle de garçon de restaurant : il prend ta commande, la transmet à la cuisine puis t'apporte le plat</li>
        </ul>
        <div class="img-api">
            <img src="img/how-a-web-api-works.png" alt="Schéma de fonctionnement d'une API">
        </div>
        <h2>Le JSON</h2>
        <p>Le JSON = JavaScript Object Notation</p>
        <p>C'est un <b>format de données</b> léger, lisible humainement, utilisé pour <b>échanger des données</b> entre un serveur et une application web, ou entre deux applications n'utilisant pas le même language</p>
        <p>À quoi ça sert ?</p>
        <ul>
            <li>Envoyer ou recevoir des données via une API</li>
            <li>Stocker des données dans un fichier</li>
            <li>Communiquer entre différentes technologies (Java, PHP, Python, Ruby, etc)</li>
        </ul>
        <pre class="line-numbers">
            <code class="language-json">
               {
                    "nom": "Jean-Michel",
                    "age": 30,
                    "email": "jean-michel@example.com",
                    "estActif": true,
                    "competences": ["HTML", "CSS", "Javascript"]
               }
            </code>
        </pre>
        <h3>Structure</h3>
        <ul>
            <li>{} : un objet</li>
            <li>Système de clé : valeur</li>
            <li>Les clés sont toujours entre guillemets</li>
            <li>Les valeurs autorisées sont :
                <ul>
                    <li>String : "Jean-Michel"</li>
                    <li>Nombre : 30</li>
                    <li>Booléen : true/false</li>
                    <li>Tableau : []</li>
                    <li>Objet : {}</li>
                    <li>null</li>
                </ul>
            </li>
        </ul>
        <h3>JSON vs Objet JavaScript</h3>
        <p>Attention ne pas confondre l'écriture d'un JSON avec un objet JS</p>
        <pre class="line-numbers">
            <code class="language-json">
               {
                    "data": [0, 2, 456],
                    "owner": "Hippolyte De La Boucherie",
                    "admin": false,
                    "employees": null
               }
            </code>
        </pre>
        <pre class="line-numbers">
            <code class="language-js">
                const user = {
                    data: [0, 2, 456],
                    owner: "Hippolyte De La Boucherie",
                    admin: false,
                    employees: null
               }
            </code>
        </pre>
        <p>Conversion JSON - Objet JavaScript</p>
        <pre class="line-numbers">
            <code class="language-js">
                // Convertir un JSON en objet JavaScript
                // On va simuler un fichier JSON

                const json = '{"nom": "Jean-Michel", "age": 30}';
                // On convertit la string JSON en objet JavaScript
                const obj = JSON.parse(json);

                console.log(obj.nom);

                // Convertir un objet JavaScript en JSON

                const user = {
                    nom: "Jean-Bon",
                    age: 12
                }

                const jsonObj = JSON.stringify(user);
                console.log(jsonObj);
            </code>
        </pre>
        <h2>Les promises</h2>
        <p>Une <b>Promise</b> (une promesse) est un objet JS qui représente une <b>opération asynchrone</b> (c'est à dire qui ne se fait pas tout de suite)</p>
        <p>Elles servent à éviter les "callback hells" (des fonctions d'appel imbriquées entre elles de façon excessive)</p>
        <p>L'enfer des rappels, aussi appelé "Pyramide de la mort" est une situtation où plusieurs rappels imbriqués sont utilisés pour gérer des opérations asynchrones en js. Cela se produit généralement lorsque plusieurs tâches asynchrones dépendent des résultats des autres</p>
        <p>Donc nous avons besoin des promesses pour améliorier la lisibilité des opérations asynchrones</p>
        <p>Les promesses ont 3 étapes</p>
        <ul>
            <li>Resolve (réussite)</li>
            <li>Rejected (échouer)</li>
            <li>Pending (état d'attente)</li>
        </ul>
        <h2>LES AJAX !!!</h2>
        <p>AJAX = Asynchronus JavaScript and XML</p>
        <p>À quoi ça sert ?</p>
        <ul>
            <li>À faire une requette HTTP sans recharger la page</li>
            <li>Envoyer ou recevoir des données depuis un serveur API</li>
            <li>Créer des applications web dynamiques (liste d'articles, formulaires, etc)</li>
        </ul>
        <p>Requête HTTP = HyperText Transfer Protocol</p>
        <p>C'est un protocole qui permet à un client, <b>votre navigateur</b> ou une application de bureau, de communiquer avec un serveur web pour échanger des données (HTML, JSON, etc)</p>
        <img src="img/csm_diagram-of-http-communication-process-fr_bb0006610b.webp" alt="Schéma du protocole HTTP">
        <ul id="huge-list"></ul>
        <div id="aled"></div>
    </main>
</body>
</html>