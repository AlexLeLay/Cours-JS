<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/fonction.js" defer></script>
    <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
    <title>Document</title>
</head>
<body>
    <main>
        <h1>Les fonctions</h1>
        <p>Une fonction est un bloc de code réutilisable qui effectue une <b>tâche précise</b></p>
        <p>Elle permet d'organiser son code et d'éviter les répétitions et rend le code plus lisible</p>
        <pre class="line-numbers">
            <code class="language-js">
                function nomDeLaFonction() {
                    // code
                }
            </code>
        </pre>
        <h3>Comment les range-t-on dans le code</h3>
        <p>Les fonctions principales sont rangées plus vers le haut que les fonctions "utilitaires"</p>
        <pre class="line-numbers">
            <code class="language-js">
                const panier = [
                    {name: "Pomme", price: 2, quantity: 5},
                    {name: "Kiwi", price: 1, quantity: 50},
                    {name: "Mangue", price: 9, quantity: 25}
                ]

                // Fonction qui additionne deux nombres
                // C'est une fonction utilitaire

                function add(nbrA, nbrB) {
                    return nbrA + nbrB;
                }

                // autre fonction utilitaire

                function multiply(nbrA, nbrB) {
                    return nbrA * nbrB;
                }

                // fonction principale qui va calculer le prix total du panier

                function calculateCartPrice(cart) {
                    // Avant de calculer il faut initialiser le total
                    let total = 0;
                    for (let i = 0; i < cart.length; i++) {
                        // Pour faciliter la lecture on renomme l'élément actuel de la boucle
                        // par une variable plus simple à écrire
                        const item = cart[i];
                        // Le return de la fonction multiply() 'injecte' son résultat dans itemPrice
                        const itemPrice = multiply(item.price, item.quantity);
                        total = add(total, itemPrice);
                    }
                    return total
                }

                console.log(calculateCartPrice(panier));

            </code>
        </pre>
        <h3>Les arguments</h3>
        <p>Un argument est une valeur qu'on donne à une fonction quand on l'appelle pour qu'elle travaille avec cette valeur</p>
        <ul>
            <li>Quand on déclare la fonction on parle de paramètres</li>
            <li>Quand on appelle la fonction on parle d'arguments</li>
        </ul>
        <pre class="line-numbers">
            <code class="language-js">
                fonction bonjour(prenom) {
                    console.log("Bonjour " + prenom);
                }

                bonjour("Jean-Michel");
            </code>
        </pre>
        <h2>Plusieurs arguments</h2>
        <p>Une fonction peut avoir autant de paramètres qu'on veut, et on doit passer le même nombre d'arguments quand on l'appelle</p>
        <p>S'il y a trop ou pas assez d'arguments, la fonction retourne indefined</p>
        <pre class="line-numbers">
            <code class="language-js">
                function add(nbrA, nbrB) {
                    return nbrA + nbrB;
                }

                console.log(add(7, 19)); // 26
            </code>
        </pre>
        <h3>Valeur par défaut</h3>
        <pre class="line-numbers">
            <code class="language-js">
                fonction bonjour(prenom = "Sebastien") {
                    console.log("Bonjour " + prenom);
                }

                bonjour(); // "Bonjour Sebastien"
            </code>
        </pre>
        <p>ATTENTION !!!!!!</p>
        <pre class="line-numbers">
            <code class="language-js">
                fonction abc(a, b = 45, c) { // erreur les paramètres
                    // optionnels doivent être en dernier
                    // code
                }

                // version corrigée
                fonction abc(a, c, b = 45) {
                    // code
                }
            </code>
        </pre>
        <!-- <input id="input" type="text" required>
        <button id="btn">Appuyer</button>
        <ul id="list">

        </ul> -->
        <h2>Les fonctions fléchées</h2>
        <p>Il existe une syntaxe plus simple et concise pour créer des fonctions, elles sont appelées fonctions fléchées</p>
        <div id="wrapper">
            <button id="btn-arrow">Test fonction fléchée</button>
        </div>
        <pre class="line-numbers">
            <code class="language-js">
                // Fonctions fléchées

                // function add(nbrA, nbrB) {
                //     return nbrA + nbrB;
                // }

                let sum = (a, b) => a + b;
                console.log(sum(12,15)); // 27
                // Quand il n'y a qu'un paramètre, les parenthèses sont facultatives
                let double = a => a * 2;
                console.log(double(140)); // 280

                let calc = (a, b, c) => {
                    let d = a * b;
                    return d - c;
                }

                console.log(calc(14,2,12)); // 16


                // autre exemple

                let maj = str => str.toUpperCase();

                console.log(maj("coucou"));

                // Problème avec this

                // exemple normal

                // function arrow() {
                //     document.addEventListener("click", function() {
                //         console.log(this);
                //     })
                // }

                let arrow = () => {
                    document.addEventListener("click", () => {
                        console.log(this);
                    })
                }

                arrow();

                const btnArrow = document.getElementById("btn-arrow");

                btnArrow.addEventListener("click", () => {
                    console.log(this);
                })
            </code>
        </pre>
        <h3>Conclusions sur les fonctions fléchées</h3>
        <ul>
            <li>POUR : Utiliser les fonctions fonctions fléchées pour les callbacks, les fonctions simples et les fonctions anonymes</li>
            <li>CONTRE : Ne pas les utiliser quand on a besoin du mot-clé "this" et "constructor"</li>
        </ul>
    </main>
</body>
</html>